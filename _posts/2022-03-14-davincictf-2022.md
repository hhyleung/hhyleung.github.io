---
title: "DaVinciCTF 2022"
excerpt: "Writeup for the DaVinciCTF 2022"
last_modified_at: 2022-03-14
stickies: true
stickies_path: "/assets/stickies/davincictf-2022.png"
toc: true
toc_label: "Challenges"
toc_sticky: true
categories:
  - Writeups
tags:
  - CTF
---

## Warmup
### FrenchFlag
`10 points` `614 solves`

> `Forensic` <br>
> Can you find the data present in our flag?
> 
> Attachment: flag.png

Basic check with `exiftool` reveals the flag at the `Creator` tag.

```bash
└─$ exiftool flag.png
ExifTool Version Number         : 12.40
File Name                       : flag.png
...
Creator                         : dvCTF{flagception}
Image Size                      : 1280x853
Megapixels                      : 1.1
```

Flag: `dvCTF{flagception}`

<br>

### EBG13
`10 points` `640 solves`

> `Crypto`<br>
> We found this message : can you decipher it?<br>
> `qiPGS{3apElcg1ba_1f_r4fl}`

The flag is encrypted with the ROT-13 cipher, which can be decrypted by shifting each character 13 places forward or with CyberChef.

Flag: `dvCTF{3ncRypt1on_1s_e4sy}`

<br>

### QmFzZTY0
`10 points` `527 solves`
> `Crypto`<br>
> Attachment: file.txt

The flag is encoded in the Base64 format and it is revealed after decoding it for 20 times using CyberChef.

Flag: `dvCTF{Base64_Is_The_Best}`

<br>

### MP3
`10 points` `218 solves`

> `Steganography`<br>
> The flag in the audio is given without the tag format!<br>
> You must fill in : dvCTF{flag}
> 
> Attachment: MP3.mp3

The flag is spoken out in the MP3 file. Reverse the audio and slow it down to listen the flag.

Flag: `dvCTF{r3v3rs3_mp3}`

<br>

### RSA
`87 points` `79 solves`

> `Easy`
> Our team has found a cipher text: there seems to be some clues to decipher it. Can you help us to read it?
> 
> ```
> n = 0x7CD1020889B4382BE84B3F14EAAE242755CC1BD56F431B348F4FF8F207A96F41AFCF3EBDF4C17CB6537AD4B01B9FF9497763B22D013B614C8FCDB0C34F9D88F1A523013791EDFEB1FBBA160799892C118892FB7F199C9957DF5A26DAB4D776E5226F06ACD05412F6DD2B1B75D24CE9DC2DDAC513BCB96CD9B97F9BEF8543A3A1
> phi = 0x7CD1020889B4382BE84B3F14EAAE242755CC1BD56F431B348F4FF8F207A96F41AFCF3EBDF4C17CB6537AD4B01B9FF9497763B22D013B614C8FCDB0C34F9D88F037D2317D3864035ECE8BCDD458711B788B5B3FDFD5164F7D736D0A56F416E8C16126E3868D73F54AF4D61F6033E069994319C849460C60A725A0F4DD97EDCC84
> e = 0x10001
> ct = 0x268D7D5F5593EA30F536635B58585620B51D2D143AFE4734635C259278D61413D0C89678E81EDF466B1E45E27EBF802F62F61263E499A516465163C7CB668F94258B3424C3E2BD76634923DECD670E4B6034F8FD00C76F9DAD00A72DB22B70B9408C89FCEE4C9B0D2D4B5664284328711BFAD57FBE1EDCC0854AAD57390DCAD6
> ```
> 
> Hint: There is another decoding step after the decryption!

First, convert the Hex numbers to Decimal using [https://www.rapidtables.com/convert/number/hex-to-decimal.html](https://www.rapidtables.com/convert/number/hex-to-decimal.html).

```
n = 87649082972615446885156213990388141958462041885187282183358321369043253078954716183685582963065012168992348062798954305060720006415266001335650005751863897735171741039420405425935144397447296138110870810719506425543947491726403454512721294407851871180512317063750030012483422248351385763316752934512386876321
phi = 87649082972615446885156213990388141958462041885187282183358321369043253078954716183685582963065012168992348062798954305060720006415266001335650005751863878602037628450194440652151553598137526621296494079379835255789373284025572667141114891644303376103362880682087270696210666254302024051328494090372669885572
e = 65537
ct = 27072622593514815453879432614324701776473574595747953216191498481974488509392434673536099100283731897243171732583922534894433636848515336632487302801454568578704912185172822029407973421574599852974535422485632743936976338461213855442178470548247222162434148032907372865397517157263392748002249405715658427094
```

Calculate the private key and use it to decrypt the ciphertext using [https://www.dcode.fr/rsa-cipher](https://www.dcode.fr/rsa-cipher) gives `100118678470123102108521039599861127251114116518811695988695828352125`.

Convert the number to ASCII text using [https://onlineasciitools.com/convert-decimal-to-ascii](https://onlineasciitools.com/convert-decimal-to-ascii) reveals the flag.

Flag: `dvCTF{fl4g_cVpH3rt3Xt_bV_RS4}`

<br>

## Steganography
### The Art of Details
`50 points` `145 solves`

> `Easy`<br>
> A simple detail can make a big difference Always beware of the first element<br>
> Warning ! flag format : dvctf{flag}
> 
> Attachment: The_Art_of_Details.docx

With the help of the Accessibility function, it showed that there are three images in the document, with a very small size located on the full stop of the first three paragraphs.

![davincictf-2022-details-1.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-details-1.jpg)

Increasing the size of the images reveal three QR codes.

![davincictf-2022-details-2.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-details-2.jpg)

The images can also be revealed and extracted with `binwalk`, as Microsoft Office documents are actually compressed files.

```bash
└─$ binwalk -e The_Art_of_Details.docx 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
...
4760          0x1298          Zip archive data, at least v1.0 to extract, compressed size: 518, uncompressed size: 518, name: word/media/image1.png
5329          0x14D1          Zip archive data, at least v1.0 to extract, compressed size: 723, uncompressed size: 723, name: word/media/image2.png
6103          0x17D7          Zip archive data, at least v1.0 to extract, compressed size: 714, uncompressed size: 714, name: word/media/image3.png
...
```

Scanning the QR code gives the following strings:

```
image1.png: aXRpc25vdHRoZWZsYWc=
image2.png: dGhla2V5ezRBajgyRDZoUlpLQThocXA1dG01fQ==
image3.png: defaw{u1qeuugx&crl0gl_4_r_fbe4a_f4hli0rm}
```

The third string looks like the encrypted flag while the first two strings are encoded in Base64, decoding it gives:

```
image1.png: itisnottheflag
image2.png: thekey{4Aj82D6hRZKA8hqp5tm5}
```

The key seems to be hinting that the flag is encrypted with the Vigenère cipher.

Since digits are not allowed to be in the key, all digits were removed from the key and `AjDhRZKAhqptm` was used to decrypt the flag using CyberChef.

Flag: `dvctf{v1genere&qrc0de_4_a_gre4t_p4ssw0rd}`

<br>

### ICMP
`292 points` `85 solves`

> `Medium`<br>
> Attachment: icmp.pcap

The data of the ICMP packets in ASCII are in Base64 format and decoding it gives the following.

```bash
This is not a flag!
Neither does this package!
Search a little more, you will eventually find ...
... They wrote a poem :) ...
In fact, the flag is not in this part of the packages, sorry...
```

Well, got to look at elsewhere.

The `id` of the packets look like Hex numbers. The packets are exported as plaintext with the “Export Packet Dissections > As Plain Text” function in WireShark.

First, the packets are arranged according to the `seq` number, then the `id` is extracted and converted from Hex number to ASCII, then decoded as Base64. The flag is then revealed.

```python
import re
import base64
ids = [0] * 32
with open("icmp.txt", "r") as f:
    lines = f.readlines()
    for line in lines:
        if("id=0x00" in line):
            seq = int(re.findall(r"seq=(\d+)", line)[0])
            ids[seq-1] = re.findall(r"id=0x00(\w+)", line)[0].decode("hex")
print(base64.b64decode("".join(ids) + "=").decode())
```

Flag: `dvCTF{h1dden_1n_the_1d}`

<br>

## OSINT
### Monkeey
`50 points` `344 solves`

> `Easy`<br>
> In what city is the statue of this monkey found? Wrap it around with the wrapper: dvCTF{city_in_lowercase}
>
> Attachment: img.png

Google searched for the image with the keyword “big balls gorilla” reveals a sculpture of the image.

![davincictf-2022-monkeey.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-monkeey.jpg)

Going to the website with the sculpture image gives more information, that the sculpture is called King Kong’s Balls and is located at Milos Forman Square, Prague, Czech Repblic.

Flag: `dvCTF{prague}`

<br>

### Elon Musk
`120 points` `115 solves`
> `Easy`<br>
> Hi,<br>
> I'm a huge fan of Elon Musk so I invested all my money in cryptocurrencies. However, I I got lost in the cryptoworld and I lost something, can you help me find it?<br>
> Sincerely,<br>
> @IL0veElon

Searching the username on Google shows a twitter account.

![davincictf-2022-elon-1.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-elon-1.jpg)

Scrolling through the account, one of the tweets looked like a hash that could be transaction ID or something.

![davincictf-2022-elon-2.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-elon-2.jpg)

Referring back to the profile section, the cryptocurrency is likely to be either `$DOGE`, `$SHIB`, or the one `$EGLD` lying in between a bunch of the other two.

With that being said, `$EGLD` transactions were being searched with the string `099627400a565a0cc64c3a61ee0ce785d80dfbd30e1b1ea8bcb9fdd9952b9b8a` at [https://explorer.elrond.com](https://explorer.elrond.com/).

The string is indeed the hash of the transaction and the flag is at the input data section.

![davincictf-2022-elon-3.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-elon-3.jpg)

Flag: `dvCTF{Bl0cKcH4In_Rul3S}`

<br>

### Welcome to the DaVinciCTF!
`440 points` `46 solves`

> `Easy`<br>
> Attachment: img.jpg

The challenge name suggests that the part with the DaVinciCTF page might contain the flag, with the URL `https://ctfd.davincicode.fr/_` and login details `Admin:ThisIsAVerySecurePassword` shown in the image.

![davincictf-2022-welcome-1.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-welcome-1.jpg)

Thought that it might require logging into the platform, but apparently just have to search for `dvctf{` or use ctrl-A to highlight all on the login page to reveal the flag in white colour near the bottom of the page.

![davincictf-2022-welcome-2.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-welcome-2.jpg)

Flag: `dvCTF{8a878c2bd9c1844aac17cd051585e2f0}`

<br>

### Painting Spot
`426 points` `51 solves`

> Found a nice painting spot, took a picture of it. But I can't remember where it is... The flag is in the form of dvCTF{} and has the flag wrapper already<br>
> Attachment: paintingSpot.zip

Used `exiftool` to look for GPS information, not quite useful but instead, found some interesting information right beneath at the `XP` tags.

```bash
└─$ exiftool paintingSpot.jpg              
ExifTool Version Number         : 12.40
File Name                       : paintingSpot.jpg
...
GPS Altitude Ref                : Above Sea Level
GPS Speed Ref                   : km/h
GPS Speed                       : 0.07419386512
GPS Img Direction Ref           : True North
GPS Img Direction               : 227.9959872
GPS Dest Bearing Ref            : True North
GPS Dest Bearing                : 227.9959872
GPS Horizontal Positioning Error: 6.047869715 m
XP Title                        : Lugar para pintar
XP Comment                      : Óptimo local para pintar, deixei uma revisão positiva
XP Keywords                     : Pintura
...
```

Google translate detected that the comments are in Portuguese. It is likely that the place is in Portugal and the comment suggests that the flag might be in a review.

![davincictf-2022-painting-1.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-painting-1.jpg)

Uploaded the image to Google to search for similar images with the keyword “portugal” to narrow down the results.

![davincictf-2022-painting-2.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-painting-2.jpg)

The top results were all pointing at the same location. Going to the website with the image and it described the place as “Best of the Azores: Ilhéu de Vila Franca”.

The place was located on Google map. From the picture provided, it should be taken somewhere on the right side on the map but not too far away from the island.

![davincictf-2022-painting-3.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-painting-3.jpg)

The beach “Praia do Corpo Santo” seems to best fit the angle. Sorted the reviews of the beach by newest and the flag was found.

![davincictf-2022-painting-4.jpg]({{ site.url }}{{ site.baseurl }}/assets/posts/davincictf-2022-painting-4.jpg)

Flag: `dvCTF{g3o_sp0tt3d}`

<br>